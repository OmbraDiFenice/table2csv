"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(l){var s={filename:"table.csv",appendTo:"body",separator:",",newline:"\n",quoteFields:!0,trimContent:!0,excludeColumns:"",excludeRows:""},u={};l.fn.table2csv=function(e,t){if("object"===_typeof(e)?(t=e,e="download"):void 0===e&&(e="download"),"string"!=typeof e)throw new Error('"action" argument must be a string');if(void 0!==t&&"object"!==_typeof(t))throw new Error('"options" argument must be an object');u=l.extend({},s,t);var o=this.filter("table");if(o.length<=0)throw new Error("table2csv must be called on a <table> element");if(1<o.length)throw new Error("converting multiple table elements at once is not supported yet");var r,n,i,a=(r="",n=o.find("tr").not(u.excludeRows),i=n.first().find("td,th").filter(":visible").not(u.excludeColumns).length,n.each(function(e,t){l(t).find("td,th").filter(":visible").not(u.excludeColumns).each(function(e,t){var o=l(t),n=u.trimContent?l.trim(o.text()):o.text();r+=u.quoteFields?'"'+n.replace(/"/g,'""')+'"':n,r+=e!==i-1?u.separator:u.newline})}),r);switch(e){case"download":!function(e,t){if(window.navigator.msSaveOrOpenBlob){var o=new Blob([t],{type:"text/csv"});window.navigator.msSaveBlob(o,e)}else{var n=document.createElement("a");n.setAttribute("href","data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}(u.filename,a);break;case"output":l(u.appendTo).append(l("<pre>").text(a));break;case"return":return a;default:throw new Error('"action" argument must be one of the supported action strings')}return this}}(jQuery);